RewriteEngine On

# Redirect all requests without the correct 'HAUTH' header to your nx domain
RewriteCond %{HTTP:HAUTH} !=___________YOUR_HAUTH___________
RewriteCond %{HTTP_HOST} !=nx.server.domain
RewriteRule ^ http://nx.server.domain [R=301,L]

# Custom error pages redirecting to your nx domain for different error codes

# Redirect 403 Forbidden errors to your nx domain
ErrorDocument 403 http://nx.server.domain

# Redirect 404 Not Found errors to your nx domain
ErrorDocument 404 http://nx.server.domain

# Redirect 500 Internal Server Error to your nx domain
ErrorDocument 500 http://nx.server.domain

# Allow access to index.php initially
RewriteCond %{REQUEST_URI} ^/$
RewriteRule ^ /index.php [L]

# If accessing index.tfl without the correct 'HAUTH' header, return a 403 Forbidden error
RewriteCond %{REQUEST_URI} ^/index\.tfl$
RewriteCond %{HTTP:HAUTH} !=___________YOUR_HAUTH___________
RewriteRule ^ - [F]

# Redirect other errors (e.g., 401 Unauthorized, 502 Bad Gateway, etc.) to your nx domain
ErrorDocument 401 http://nx.server.domain
ErrorDocument 502 http://nx.server.domain
ErrorDocument 503 http://nx.server.domain
ErrorDocument 504 http://nx.server.domain